CREATE TABLE CFG_PARAMETERS (
    PARAM_ID        NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    PARAM_NAME      VARCHAR2(100) NOT NULL,
    PARAM_VALUE     VARCHAR2(4000),
    CATEGORY_CODE   VARCHAR2(50) REFERENCES LKP_PARAM_CATEGORY(CATEGORY_CODE),
    VALUE_TYPE      VARCHAR2(15) DEFAULT 'STR' REFERENCES LKP_PARAM_VALUE_TYPE(VALUE_TYPE),
    DEFAULT_SCOPE   VARCHAR2(10) DEFAULT 'APP' REFERENCES LKP_PARAM_SCOPE_TYPE(SCOPE_TYPE),
    TENANT_ID       VARCHAR2(50) REFERENCES TENANTS(TENANT_ID),
    APP_ID          NUMBER,
    IS_SECRET       CHAR(1) DEFAULT 'N' CHECK (IS_SECRET IN ('Y','N')),
    IS_ACTIVE       CHAR(1) DEFAULT 'Y' CHECK (IS_ACTIVE IN ('Y','N')),
    DESCRIPTION     VARCHAR2(2000),
    LAST_UPDATED_BY VARCHAR2(100),
    LAST_UPDATED_ON DATE DEFAULT SYSDATE,
    CONSTRAINT UQ_CFG_PARAM_CTX UNIQUE (TENANT_ID, APP_ID, PARAM_NAME)
);

 
CREATE TABLE CFG_PARAM_OVERRIDES (
    OVERRIDE_ID    NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    PARAM_ID       NUMBER NOT NULL REFERENCES CFG_PARAMETERS(PARAM_ID) ON DELETE CASCADE,
    TENANT_ID      VARCHAR2(50),
    APP_ID         NUMBER,
    SCOPE_TYPE     VARCHAR2(10) REFERENCES LKP_PARAM_SCOPE_TYPE(SCOPE_TYPE),
    SCOPE_VALUE    VARCHAR2(100),
    OVERRIDE_VALUE VARCHAR2(4000),
    IS_ACTIVE      CHAR(1) DEFAULT 'Y' CHECK (IS_ACTIVE IN ('Y','N')),
    EXPIRY_DATE    DATE,
    CREATED_BY     VARCHAR2(100),
    CREATED_ON     DATE DEFAULT SYSDATE
);

CREATE INDEX IDX_CFG_OVERRIDE_CTX ON CFG_PARAM_OVERRIDES (TENANT_ID, APP_ID, PARAM_ID, SCOPE_TYPE, SCOPE_VALUE);
